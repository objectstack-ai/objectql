# File: hr_timesheet.object.yml
# Object name is inferred from filename as 'hr_timesheet'
label: Timesheet
description: Employee time tracking
icon: time-line

ai_context:
  intent: "Track employee work hours and attendance"
  domain: human_resources
  aliases: [timesheet, attendance, time card]
  common_queries:
    - "Show timesheets for approval"
    - "Find timesheets by employee and date"
    - "List overtime hours by department"

fields:
  employee:
    type: lookup
    reference_to: hr_employee
    label: Employee
    required: true
    index: true
    ai_context:
      intent: "Employee submitting time worked"
      semantic_type: association
  
  work_date:
    type: date
    required: true
    label: Work Date
    index: true
  
  clock_in:
    type: datetime
    label: Clock In Time
  
  clock_out:
    type: datetime
    label: Clock Out Time
  
  total_hours:
    type: number
    label: Total Hours
    scale: 2
  
  regular_hours:
    type: number
    label: Regular Hours
    scale: 2
  
  overtime_hours:
    type: number
    label: Overtime Hours
    scale: 2
  
  break_hours:
    type: number
    label: Break Hours
    scale: 2
  
  work_type:
    type: select
    options:
      - label: Office
        value: office
      - label: Remote
        value: remote
      - label: Field
        value: field
      - label: Client Site
        value: client_site
    defaultValue: office
    index: true
    ai_context:
      intent: "Work location for tracking remote vs on-site"
      selection_guidance: "Remote for work from home; Field for on-location work"
  
  status:
    type: select
    options:
      - label: Draft
        value: draft
      - label: Submitted
        value: submitted
      - label: Approved
        value: approved
      - label: Rejected
        value: rejected
    defaultValue: draft
    required: true
    index: true
    ai_context:
      intent: "Approval workflow state"
      is_state_machine: true
      transitions:
        draft: [submitted]
        submitted: [approved, rejected]
        approved: []
        rejected: [draft]
  
  approved_by:
    type: lookup
    reference_to: user
    label: Approved By
    ai_context:
      intent: "Manager who approved the timesheet"
      semantic_type: association
  
  approved_at:
    type: datetime
    label: Approval Time
  
  notes:
    type: textarea
    label: Notes

indexes:
  # For employee timesheet lookup
  employee_date_idx:
    fields: [employee, work_date]
    unique: true
  
  # For approval workflow
  status_employee_idx:
    fields: [status, employee]
  
  # For date range reports
  work_date_status_idx:
    fields: [work_date, status]

actions:
  submit:
    type: record
    label: Submit for Approval
    icon: send-plane-line
  
  approve:
    type: record
    label: Approve Timesheet
    icon: checkbox-circle-line
  
  reject:
    type: record
    label: Reject Timesheet
    icon: close-circle-line
    params:
      reason:
        type: textarea
        label: Rejection Reason
        required: true
