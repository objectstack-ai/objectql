# File: project_milestone.object.yml
# Object name is inferred from filename as 'project_milestone'
label: Milestone
description: Project milestone or checkpoint
icon: flag-line

ai_context:
  intent: "Track major project milestones and deliverables"
  domain: project_management
  aliases: [milestone, checkpoint, deliverable]
  common_queries:
    - "Show upcoming milestones"
    - "Find milestones by project"
    - "List completed milestones by date"

fields:
  name:
    type: text
    required: true
    label: Milestone Name
    index: true
    ai_context:
      intent: "Descriptive name of the milestone"
  
  project:
    type: lookup
    reference_to: project_project
    label: Project
    required: true
    index: true
    ai_context:
      intent: "Project this milestone belongs to"
      semantic_type: hierarchy
  
  description:
    type: textarea
    label: Description
  
  due_date:
    type: date
    required: true
    label: Target Date
    index: true
  
  completed_date:
    type: date
    label: Completion Date
  
  status:
    type: select
    label: Milestone Status
    options:
      - label: Pending
        value: pending
      - label: In Progress
        value: in_progress
      - label: Completed
        value: completed
      - label: Missed
        value: missed
    defaultValue: pending
    required: true
    index: true
    ai_context:
      intent: "Current state of milestone progress"
      is_state_machine: true
      transitions:
        pending: [in_progress]
        in_progress: [completed, missed]
        completed: []
        missed: []
  
  owner:
    type: lookup
    reference_to: user
    label: Milestone Owner
    ai_context:
      intent: "Person responsible for delivering this milestone"
      semantic_type: ownership
  
  deliverables:
    type: textarea
    label: Deliverables
  
  success_criteria:
    type: textarea
    label: Success Criteria

indexes:
  # For project milestones
  project_due_date_idx:
    fields: [project, due_date]
  
  # For status tracking
  status_due_date_idx:
    fields: [status, due_date]

actions:
  mark_completed:
    type: record
    label: Mark as Completed
    icon: checkbox-circle-line
