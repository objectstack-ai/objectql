# File: crm_contact.object.yml
# Object name is inferred from filename as 'crm_contact'
label: Contact
description: Individual contact person
icon: user-line

ai_context:
  intent: "Manage individual contacts and decision-makers at accounts"
  domain: customer_relationship_management
  aliases: [contact, person, decision maker]
  common_queries:
    - "Find contacts by account"
    - "Show contacts by job title"
    - "List active contacts with email"

fields:
  first_name:
    type: text
    required: true
    label: First Name
    index: true
  
  last_name:
    type: text
    required: true
    label: Last Name
    index: true
  
  full_name:
    type: formula
    formula: "CONCAT(first_name, ' ', last_name)"
    label: Full Name
  
  email:
    type: text
    label: Email
    unique: true
    index: true
  
  phone:
    type: text
    label: Phone
  
  mobile:
    type: text
    label: Mobile
  
  title:
    type: text
    label: Job Title
    index: true
  
  department:
    type: text
    label: Department
  
  account:
    type: lookup
    reference_to: crm_account
    label: Account
    required: true
    index: true
    ai_context:
      intent: "Company or organization this contact belongs to"
      semantic_type: hierarchy
  
  owner:
    type: lookup
    reference_to: user
    label: Contact Owner
    index: true
    ai_context:
      intent: "Sales representative managing this contact"
      semantic_type: ownership
  
  lead_source:
    type: select
    options:
      - label: Web
        value: web
      - label: Referral
        value: referral
      - label: Trade Show
        value: trade_show
      - label: Partner
        value: partner
      - label: Other
        value: other
    label: Lead Source
    index: true
    ai_context:
      intent: "Original source of the contact for attribution"
  
  linkedin_url:
    type: url
    label: LinkedIn Profile
  
  description:
    type: textarea
    label: Notes
  
  status:
    type: select
    options:
      - label: Active
        value: active
      - label: Inactive
        value: inactive
    defaultValue: active
    index: true
    ai_context:
      intent: "Current status of contact engagement"
      is_state_machine: true
      transitions:
        active: [inactive]
        inactive: [active]

indexes:
  # For account contact lookup
  account_status_idx:
    fields: [account, status]
  
  # For owner queries
  owner_account_idx:
    fields: [owner, account]
  
  # For name search
  name_idx:
    fields: [last_name, first_name]

ai:
  search:
    enabled: true
    fields: [first_name, last_name, email, title]
    model: text-embedding-3-small
