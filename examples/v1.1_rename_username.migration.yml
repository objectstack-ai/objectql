# Example Migration File: Rename Username Field
# File: v1.1_rename_username.migration.yml
#
# This is an example of how to define schema evolution migrations
# in YAML format. The filename (without .migration.yml) becomes the
# migration ID automatically.

# Semantic version for this migration
version: 1.1.0

# Human-readable name
name: Rename Username Field

# Detailed description of what this migration does
description: |
  Rename the 'username' field to 'user_name' in the users object
  for consistency with naming conventions across all objects.

# Author or team responsible for this migration
author: dev-team

# Timestamp when migration was created (ISO 8601)
created_at: 2026-01-14T00:00:00Z

# Ordered list of migration steps
steps:
  # Step 1: Rename the field
  - id: step_1
    name: Rename username field in users object
    description: Update field name from username to user_name
    
    # The schema change instruction
    instruction:
      type: field_update
      object_name: users
      field_name: username
      new_field_name: user_name
      
      # Changes to apply to the field
      changes:
        label: User Name
      
      # How to handle existing data
      # Options: auto, manual, preserve, clear
      data_migration_strategy: auto
      
      description: Rename for naming consistency
      reason: Align with naming conventions across all objects
    
    # Can this step be automatically rolled back?
    reversible: true

# Can the entire migration be rolled back?
reversible: true

# Tags for categorization
tags:
  - refactor
  - naming

# ========================================
# Migration Strategy Definitions
# ========================================

# data_migration_strategy options:
#   - auto: Attempt automatic data conversion (safe for renames)
#   - manual: Requires custom transformation script
#   - preserve: Keep data as-is (may cause validation errors)
#   - clear: Set field to null/default for all records

# deletion_strategy options (for field/object deletion):
#   - drop: Permanently remove (irreversible)
#   - archive: Move to backup location (reversible)
#   - soft: Mark as deleted but keep data (reversible)

# cascade_strategy options (for object deletion):
#   - cascade: Also delete related records
#   - fail: Fail if dependent records exist
#   - nullify: Set foreign key references to null
