label: Expense
description: Company expense record
icon: wallet-line

fields:
  expense_number:
    type: text
    required: true
    label: Expense Number
    unique: true
    index: true
  
  employee:
    type: lookup
    reference_to: hr_employee
    label: Employee
    required: true
    index: true
  
  expense_date:
    type: date
    required: true
    label: Expense Date
    index: true
  
  category:
    type: select
    options:
      - travel
      - meals
      - office_supplies
      - software
      - marketing
      - utilities
      - rent
      - training
      - other
    required: true
    index: true
  
  amount:
    type: currency
    required: true
    label: Amount
  
  currency:
    type: select
    options:
      - USD
      - EUR
      - GBP
      - CNY
      - JPY
    defaultValue: USD
  
  merchant:
    type: text
    label: Merchant/Vendor
  
  description:
    type: textarea
    required: true
    label: Description
  
  receipt_url:
    type: file
    label: Receipt Attachment
  
  status:
    type: select
    options:
      - draft
      - submitted
      - approved
      - rejected
      - reimbursed
    defaultValue: draft
    required: true
    index: true
  
  approved_by:
    type: lookup
    reference_to: user
    label: Approved By
  
  approved_at:
    type: datetime
    label: Approval Time
  
  reimbursed_at:
    type: date
    label: Reimbursement Date
  
  department:
    type: lookup
    reference_to: hr_department
    label: Department
    index: true
  
  project:
    type: lookup
    reference_to: project_project
    label: Related Project

indexes:
  # For employee expense lookup
  employee_status_idx:
    fields: [employee, status]
  
  # For category analysis
  category_date_idx:
    fields: [category, expense_date]
  
  # For approval workflow
  status_date_idx:
    fields: [status, expense_date]
  
  # For department budget tracking
  department_category_idx:
    fields: [department, category]

actions:
  submit:
    type: record
    label: Submit for Approval
    icon: send-plane-line
  
  approve:
    type: record
    label: Approve Expense
    icon: checkbox-circle-line
  
  reject:
    type: record
    label: Reject Expense
    icon: close-circle-line
    params:
      reason:
        type: textarea
        label: Rejection Reason
        required: true
  
  reimburse:
    type: record
    label: Mark as Reimbursed
    icon: money-dollar-circle-line
    params:
      reimbursement_date:
        type: date
        label: Reimbursement Date
        required: true
