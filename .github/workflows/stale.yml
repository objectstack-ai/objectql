name: "Stale Issue Management"

on:
  schedule:
    # Run every day at 00:00 UTC
    - cron: '0 0 * * *'
  workflow_dispatch:

permissions:
  issues: write
  pull-requests: write

jobs:
  stale:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    steps:
      - name: Mark/Close Stale Issues and PRs
        uses: actions/stale@v9
        with:
          repo-token: ${{ secrets.GITHUB_TOKEN }}
          
          # Issues
          stale-issue-message: >
            This issue has been automatically marked as stale because it has not had
            recent activity. It will be closed in 14 days if no further activity occurs.
            Thank you for your contributions.
          close-issue-message: >
            This issue was automatically closed because it has not had activity for 74 days
            (marked stale after 60 days, then closed after 14 more days of inactivity).
            Please feel free to reopen if you believe this issue is still relevant.
          days-before-issue-stale: 60
          days-before-issue-close: 14
          stale-issue-label: 'stale'
          exempt-issue-labels: 'pinned,security,roadmap,help wanted'
          
          # Pull Requests
          stale-pr-message: >
            This pull request has been automatically marked as stale because it has not had
            recent activity. It will be closed in 7 days if no further activity occurs.
            Please address any review comments or conflicts.
          close-pr-message: >
            This pull request was automatically closed because it has not had activity for 37 days
            (marked stale after 30 days, then closed after 7 more days of inactivity).
            Please feel free to reopen and address the review comments if you wish to continue.
          days-before-pr-stale: 30
          days-before-pr-close: 7
          stale-pr-label: 'stale'
          exempt-pr-labels: 'pinned,security,in progress'
          
          # General settings
          operations-per-run: 100
          remove-stale-when-updated: true
          ascending: false
